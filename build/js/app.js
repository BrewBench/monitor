"use strict";angular.module("brewbench",["ui.router","nvd3","ngTouch","duScroll","ui.knob"]).config(function(e,t,r){r.defaults.useXDomain=!0,r.defaults.headers.common="Content-Type: application/json",delete r.defaults.headers.common["X-Requested-With"],e.state("home",{url:"",templateUrl:"views/monitor.html",controller:"mainCtrl"}).state("arduino",{url:"/arduino/:domain",templateUrl:"views/monitor.html",controller:"mainCtrl"}).state("otherwise",{url:"*path",templateUrl:"views/not-found.html"})}),angular.module("brewbench").controller("mainCtrl",function(e,t,r,n,i,a,o,u){function s(t,r){if(!t||!t.temp)return!1;e.error_message="";var i=[],a=new Date;return r.temp.previous="F"==e.settings.unit?n("toFahrenheit")(t.temp):Math.round(t.temp),r.temp.current=r.temp.previous+r.temp.adjust,r.values.length>c&&e.kettles.map(function(e){return e.values=[]}),r.values.push([a.getTime(),r.temp.current]),e.updateKnobCopy(r),r.temp.current>=r.temp.target+r.temp.diff?(e.alert(r),r.heater.auto&&r.heater.running&&i.push(u.digital(r.heater.pin,0).then(function(){r.heater.running=!1},function(t){e.error_message=t&&"string"==typeof t?t:"Could not connect to the Arduino at "+u.domain()})),r.pump.auto&&r.pump.running&&i.push(u.digital(r.pump.pin,0).then(function(){r.pump.running=!1},function(t){e.error_message=t&&"string"==typeof t?t:"Could not connect to the Arduino at "+u.domain()})),r.cooler&&r.cooler.auto&&!r.cooler.running&&i.push(u.digital(r.heater.pin,1).then(function(){r.heater.running=!0,r.knob.subText.text="cooling",r.knob.subText.color="rgba(52,152,219,1)"},function(t){e.error_message=t&&"string"==typeof t?t:"Could not connect to the Arduino at "+u.domain()}))):r.temp.current<=r.temp.target-r.temp.diff?(e.alert(r),r.heater.auto&&!r.heater.running&&i.push(u.digital(r.heater.pin,1).then(function(){r.heater.running=!0,r.knob.subText.text="heating",r.knob.subText.color="rgba(200,47,47,1)"},function(t){e.error_message=t&&"string"==typeof t?t:"Could not connect to the Arduino at "+u.domain()})),r.pump.auto&&!r.pump.running&&i.push(u.digital(r.pump.pin,1).then(function(){r.pump.running=!0},function(t){e.error_message=t&&"string"==typeof t?t:"Could not connect to the Arduino at "+u.domain()})),r.cooler&&r.cooler.auto&&r.cooler.running&&i.push(u.digital(r.heater.pin,0).then(function(){r.heater.running=!1},function(t){e.error_message=t&&"string"==typeof t?t:"Could not connect to the Arduino at "+u.domain()}))):(r.temp.hit=new Date,e.alert(r)),o.all(i)}var f=null,c=100,l=null;e.hops,e.grains,e.water,e.lovibond,e.kettleTypes=u.kettleTypes(),e.chartOptions=u.chartOptions(),e.sensorTypes=u.sensorTypes,e.showSettings=!0,e.error_message="",e.getLovibondColor=function(t){if(t=t.replace(/°/g,"").replace(/ /g,""),-1!==t.indexOf("-")){var r=t.split("-");t=(parseFloat(r[0])+parseFloat(r[1]))/2}else t=parseFloat(t);if(!t)return"";var n=_.filter(e.lovibond,function(e){return e.srm<=t?e.hex:""});return n.length?n[n.length-1].hex:""},e.settings=u.settings("settings")||{pollSeconds:10,unit:"F",arduinoUrl:"192.168.240.1",ports:{analog:5,digital:13},recipe:{name:"",yeast:[],scale:"gravity",method:"papazian",og:0,fg:0,abv:0,abw:0,calories:0,attenuation:0},notifications:{on:!0,timers:!0,high:!0,low:!0,target:!0,slack:"Slack notification webhook Url",last:""},sounds:{on:!0,alert:"/assets/audio/bike.mp3",timer:"/assets/audio/school.mp3"}},e.showSettingsSide=function(){e.showSettings=!e.showSettings},e.updateABV=function(){"gravity"==e.settings.recipe.scale?("papazian"==e.settings.recipe.method?e.settings.recipe.abv=u.abv(e.settings.recipe.og,e.settings.recipe.fg):e.settings.recipe.abv=u.abva(e.settings.recipe.og,e.settings.recipe.fg),e.settings.recipe.abw=u.abw(e.settings.recipe.abv,e.settings.recipe.fg),e.settings.recipe.attenuation=u.attenuation(u.plato(e.settings.recipe.og),u.plato(e.settings.recipe.fg)),e.settings.recipe.calories=u.calories(e.settings.recipe.abw,u.re(u.plato(e.settings.recipe.og),u.plato(e.settings.recipe.fg)),e.settings.recipe.fg)):("papazian"==e.settings.recipe.method?e.settings.recipe.abv=u.abv(u.sg(e.settings.recipe.og),u.sg(e.settings.recipe.fg)):e.settings.recipe.abv=u.abva(u.sg(e.settings.recipe.og),u.sg(e.settings.recipe.fg)),e.settings.recipe.abw=u.abw(e.settings.recipe.abv,u.sg(e.settings.recipe.fg)),e.settings.recipe.attenuation=u.attenuation(e.settings.recipe.og,e.settings.recipe.fg),e.settings.recipe.calories=u.calories(e.settings.recipe.abw,u.re(e.settings.recipe.og,e.settings.recipe.fg),u.sg(e.settings.recipe.fg)))},e.changeMethod=function(t){e.settings.recipe.method=t,e.updateABV()},e.changeScale=function(t){e.settings.recipe.scale=t,"gravity"==t?(e.settings.recipe.og=u.sg(e.settings.recipe.og),e.settings.recipe.fg=u.sg(e.settings.recipe.fg)):(e.settings.recipe.og=u.plato(e.settings.recipe.og),e.settings.recipe.fg=u.plato(e.settings.recipe.fg))},e.updateABV(),e.urls=u.settings("urls")||[],!e.urls.length&&e.settings.arduinoUrl&&e.urls.push(e.settings.arduinoUrl),t.domain&&(e.settings.arduinoUrl=t.domain),e.knobOptions={readOnly:!0,unit:"°",subText:{enabled:!0,text:"",color:"gray",font:"auto"},trackWidth:40,barWidth:25,barCap:25,trackColor:"#ddd",barColor:"#777",dynamicOptions:!0,displayPrevious:!0,prevBarColor:"#777"},e.kettles=u.settings("kettles")||[{key:"Boil",type:"hop",active:!1,heater:{pin:2,running:!1,auto:!1},pump:{pin:3,running:!1,auto:!1},temp:{pin:0,type:"Thermistor",hit:!1,current:0,previous:0,adjust:0,target:200,diff:5},values:[],timers:[],knob:angular.merge(e.knobOptions,{value:0,min:0,max:205})},{key:"Hot Liquor",type:"water",active:!1,heater:{pin:4,running:!1,auto:!1},pump:{pin:5,running:!1,auto:!1},temp:{pin:1,type:"Thermistor",hit:!1,current:0,previous:0,adjust:0,target:200,diff:5},values:[],timers:[],knob:angular.merge(e.knobOptions,{value:0,min:0,max:205})},{key:"Mash",type:"grain",active:!1,heater:{pin:6,running:!1,auto:!1},pump:{pin:7,running:!1,auto:!1},temp:{pin:2,type:"Thermistor",hit:!1,current:0,previous:0,adjust:0,target:150,diff:5},values:[],timers:[],knob:angular.merge(e.knobOptions,{value:0,min:0,max:155})}],e.getPortRange=function(e){return e++,Array(e).fill().map(function(e,t){return 0+t})},e.addKettle=function(){e.kettles.length<5&&e.kettles.push({key:e.kettleTypes[0].name,type:e.kettleTypes[0].type,active:!1,heater:{pin:6,running:!1,auto:!1},pump:{pin:7,running:!1,auto:!1},temp:{pin:0,type:"Thermistor",hit:!1,current:0,previous:0,adjust:0,target:e.kettleTypes[0].target,diff:e.kettleTypes[0].diff},values:[],timers:[],knob:angular.merge(e.knobOptions,{value:0,min:0,max:e.kettleTypes[0].target+e.kettleTypes[0].diff})})},e.activeKettles=function(){return _.filter(e.kettles,{active:!0}).length},e.pinInUse=function(t,r){return _.find(e.kettles,function(e){return r&&"Thermistor"==e.temp.type&&e.temp.pin==t||!r&&"DS18B20"==e.temp.type&&e.temp.pin==t||r&&"PT100"==e.temp.type&&e.temp.pin==t||!r&&e.heater.pin==t||!r&&e.cooler&&e.cooler.pin==t||!r&&!e.cooler&&e.pump.pin==t})||!1},e.pinChange=function(t,r,n){var i=e.pinInUse(r,n);i&&(i.temp.pin==r?i.temp.pin=t:i.heater.pin==r?i.heater.pin=t:i.pump.pin==r&&(i.pump.pin=t))},e.importRecipe=function(t,r){var n,i=u.formatXML(t),a=null;if(i){n=(new X2JS).xml_str2json(i)}if(!n)return e.recipe_success=!1;if("bsmx"==r){if(n.Recipes&&n.Recipes.Data.Recipe?a=n.Recipes.Data.Recipe:n.Selections&&n.Selections.Data.Recipe&&(a=n.Selections.Data.Recipe),!a)return e.recipe_success=!1;a=u.recipeBeerSmith(a)}else if("xml"==r){if(n.RECIPES&&n.RECIPES.RECIPE&&(a=n.RECIPES.RECIPE),!a)return e.recipe_success=!1;a=u.recipeBeerXML(a)}if(!a)return e.recipe_success=!1;if(a.og&&(e.settings.recipe.og=a.og),a.fg&&(e.settings.recipe.fg=a.fg),e.settings.recipe.name=a.name,e.settings.recipe.category=a.category,e.settings.recipe.abv=a.abv,a.grains.length){var o=_.filter(e.kettles,{type:"grain"})[0];o&&(o.timers=[],_.each(a.grains,function(t){e.addTimer(o,{label:t.label,min:t.min,notes:t.notes})}))}if(a.hops.length){var o=_.filter(e.kettles,{type:"hop"})[0];o&&(o.timers=[],_.each(a.hops,function(t){e.addTimer(o,{label:t.label,min:t.min,notes:t.notes})}))}if(a.misc.length){var o=_.filter(e.kettles,{type:"hop"})[0];o&&_.each(a.misc,function(t){e.addTimer(o,{label:t.label,min:t.min})})}a.yeast&&_.each(a.yeast,function(t){e.settings.recipe.yeast.push({name:t.name})}),e.recipe_success=!0},e.loadConfig=function(){var t=[];return e.pkg||t.push(u.pkg().then(function(t){return e.pkg=t,e.settings.sketch_version=t.sketch_version})),e.grains||t.push(u.grains().then(function(t){return e.grains=_.sortBy(_.uniqBy(t,"name"),"name")})),e.hops||t.push(u.hops().then(function(t){return e.hops=_.sortBy(_.uniqBy(t,"name"),"name")})),e.water||t.push(u.water().then(function(t){return e.water=_.sortBy(_.uniqBy(t,"salt"),"salt")})),e.lovibond||t.push(u.lovibond().then(function(t){return e.lovibond=t})),o.all(t)},e.init=function(){var t=[];return _.each(e.kettles,function(r){r.knob.max=r.temp.target+r.temp.diff,t.push(u.digitalRead(r.heater.pin,2e3).then(function(e){return"1"==e.value?(r.active=!0,r.heater.running=!0):r.heater.running=!1,r},function(e){return e})),t.push(u.digitalRead(r.pump.pin,2e3).then(function(e){return"1"==e.value?(r.active=!0,r.pump.running=!0):r.pump.running=!1,r},function(e){return e})),r.cooler&&t.push(u.digitalRead(r.cooler.pin,2e3).then(function(e){return"1"==e.value?(r.active=!0,r.cooler.running=!0):r.cooler.running=!1,r},function(e){return e})),r.timers&&r.timers.length&&_.each(r.timers,function(t){t.running?(t.running=!1,e.timerStart(t,r)):!t.running&&t.queue?i(function(){e.timerStart(t,r)},6e4):t.up&&t.up.running&&(t.up.running=!1,e.timerStart(t.up))}),e.updateKnobCopy(r)}),o.all(t)},e.getNavOffset=function(){return 55+angular.element(document.getElementById("navbar"))[0].offsetHeight},e.addTimer=function(e,t){e.timers||(e.timers=[]),t?(t.min=t.min?t.min:0,t.sec=t.sec?t.sec:0,t.running=!!t.running&&t.running,t.queue=!!t.queue&&t.queue,e.timers.push(t)):e.timers.push({label:"Edit label",min:60,sec:0,running:!1,queue:!1})},e.removeTimers=function(e,t){var r=angular.element(e.target);r.hasClass("fa-trash")&&(r=r.parent()),r.hasClass("btn-danger")?(r.removeClass("btn-danger").addClass("btn-default"),t.timers=[]):(r.removeClass("btn-default").addClass("btn-danger"),i(function(){r.removeClass("btn-danger").addClass("btn-default")},1e3))},e.toggleKettle=function(t,r){var n;switch(t){case"heat":n=r.heater;break;case"cool":n=r.cooler;break;case"pump":n=r.pump}n&&(n.running=!n.running,r.active&&n.running?u.digital(n.pin,1).then(function(){},function(t){e.error_message=t&&"string"==typeof t?t:"Could not connect to the Arduino at "+u.domain()}):n.running||u.digital(n.pin,0).then(function(){},function(t){e.error_message=t&&"string"==typeof t?t:"Could not connect to the Arduino at "+u.domain()}))},e.knobClick=function(e){e.temp.previous&&(e.temp.adjust=e.temp.current-e.temp.previous)},e.startStopKettle=function(t){t.active=!t.active,t.active?(u.temp(t.temp).then(function(e){s(e,t)},function(t){e.error_message=t&&"string"==typeof t?t:"Could not connect to the Arduino at "+u.domain()}),t.knob.subText.text="starting...",t.knob.readOnly=!1):t.knob.readOnly=!0,!t.active&&t.heater.running&&u.digital(t.heater.pin,0).then(function(){t.heater.running=!1,e.updateKnobCopy(t)},function(t){e.error_message=t&&"string"==typeof t?t:"Could not connect to the Arduino at "+u.domain()}),!t.active&&t.pump.running&&u.digital(t.pump.pin,0).then(function(){t.pump.running=!1,e.updateKnobCopy(t)},function(t){e.error_message=t&&"string"==typeof t?t:"Could not connect to the Arduino at "+u.domain()}),t.cooler&&!t.active&&t.cooler.running&&u.digital(t.cooler.pin,0).then(function(){t.cooler.running=!1,e.updateKnobCopy(t)},function(t){e.error_message=t&&"string"==typeof t?t:"Could not connect to the Arduino at "+u.domain()}),t.active||(t.pump.auto=!1,t.heater.auto=!1,t.cooler&&(t.cooler.auto=!1),e.updateKnobCopy(t))},e.clearKettles=function(e,t){angular.element(e.target).html("Removing..."),u.clear(),i(function(){window.location.reload()},1e3)},e.alert=function(t,r){if((r||!t||t.temp.hit)&&!1!==e.settings.notifications.on){var n,i="/assets/img/brewbench-logo.png",a="good";if(t&&-1!==["hop","grain","water"].indexOf(t.type)&&(i="/assets/img/"+t.type+".png"),!(t&&t.low&&t.heater.running)){if(r){if(!e.settings.notifications.timers)return;n=r.up?"Your timers are done":r.notes?"Time to add "+r.notes+" of "+r.label:"Time to add "+r.label}else if(t&&t.high){if(!e.settings.notifications.high||"high"==e.settings.notifications.last)return;n="Your "+t.key+" kettle is "+t.high+"° high",a="danger",e.settings.notifications.last="high"}else if(t&&t.low){if(!e.settings.notifications.low||"low"==e.settings.notifications.last)return;n="Your "+t.key+" kettle is "+t.low+"° low",a="#3498DB",e.settings.notifications.last="low"}else if(t){if(!e.settings.notifications.target||"target"==e.settings.notifications.last)return;n="Your "+t.key+" kettle is within the target at "+t.temp.current+"°",a="good",e.settings.notifications.last="target"}else t||(n="Testing Alerts, you are ready to go, click play on a kettle.");if("vibrate"in navigator&&navigator.vibrate([500,300,500]),!0===e.settings.sounds.on){if(r&&t&&t.low&&t.heater.running)return;new Audio(r?e.settings.sounds.timer:e.settings.sounds.alert).play()}"Notification"in window&&(f&&f.close(),"granted"===Notification.permission?n&&(f=t?new Notification(t.key+" kettle",{body:n,icon:i}):new Notification("Test kettle",{body:n,icon:i})):"denied"!==Notification.permission&&Notification.requestPermission(function(e){"granted"===e&&n&&(f=new Notification(t.key+" kettle",{body:n,icon:i}))})),-1!==e.settings.notifications.slack.indexOf("http")&&u.slack(e.settings.notifications.slack,n,a,i,t).then(function(e){})}}},e.updateKnobCopy=function(e){if(!e.active)return e.knob.trackColor="#ddd",e.knob.barColor="#777",e.knob.subText.text="not running",void(e.knob.subText.color="gray");e.temp.current>e.temp.target+e.temp.diff?(e.knob.barColor="rgba(255,0,0,.6)",e.knob.trackColor="rgba(255,0,0,.1)",e.high=e.temp.current-e.temp.target,e.low=null,e.cooler&&e.cooler.running?(e.knob.subText.text="cooling",e.knob.subText.color="rgba(52,152,219,1)"):(e.knob.subText.text=e.high+"° high",e.knob.subText.color="rgba(255,0,0,.6)")):e.temp.current<e.temp.target-e.temp.diff?(e.knob.barColor="rgba(52,152,219,.5)",e.knob.trackColor="rgba(52,152,219,.1)",e.low=e.temp.target-e.temp.current,e.high=null,e.heater.running?(e.knob.subText.text="heating",e.knob.subText.color="rgba(255,0,0,.6)"):(e.knob.subText.text=e.low+"° low",e.knob.subText.color="rgba(52,152,219,1)")):(e.knob.barColor="rgba(44,193,133,.6)",e.knob.trackColor="rgba(44,193,133,.1)",e.knob.subText.text="within target",e.knob.subText.color="gray",e.low=null,e.high=null)},e.changeKettleType=function(t){var r=_.findIndex(e.kettleTypes,{type:t.type});r++;var n=e.kettleTypes[r]?e.kettleTypes[r]:e.kettleTypes[0];t.key=n.name,t.type=n.type,t.temp.target=n.target,t.temp.diff=n.diff,t.knob=angular.merge(e.knobOptions,{value:t.temp.current,min:0,max:n.target+n.diff}),"fermenter"===n.type?t.cooler={pin:2,running:!1,auto:!1}:delete t.cooler},e.changeUnits=function(t){e.settings.unit!=t&&(e.settings.unit=t,_.each(e.kettles,function(r){r.temp.current=n("formatDegrees")(r.temp.current,t),r.temp.target=n("formatDegrees")(r.temp.target,t),r.knob.value=r.temp.current,r.knob.max=r.temp.target+r.temp.diff,e.updateKnobCopy(r)}),e.chartOptions=u.chartOptions(t))},e.timerRun=function(t,r){return a(function(){t.up||0!=t.min||0!=t.sec?!t.up&&t.sec>0?t.sec--:t.up&&t.up.sec<59?t.up.sec++:t.up?t.up&&(t.up.sec=0,t.up.min++):(r&&_.each(_.filter(r.timers,{running:!1,min:t.min,queue:!1}),function(t){e.alert(r,t),t.queue=!0,i(function(){e.timerStart(t,r)},6e4)}),t.sec=59,t.min--):(t.running=!1,t.up={min:0,sec:0,running:!0},r&&_.filter(r.timers,{up:{running:!0}}).length==r.timers.length&&e.alert(r,t))},1e3)},e.timerStart=function(t,r){t.up&&t.up.running?(t.up.running=!1,a.cancel(t.interval)):t.running?(t.running=!1,a.cancel(t.interval)):(t.running=!0,t.queue=!1,t.interval=e.timerRun(t,r))},e.processTemps=function(){var t=[];return _.each(e.kettles,function(r){r.active&&t.push(u.temp(r.temp).then(function(e){return s(e,r)},function(t){return e.error_message=t&&"string"==typeof t?t:"Could not connect to the Arduino at "+u.domain(),t}))}),o.all(t).then(function(t){i(function(){return e.processTemps()},1e3*e.settings.pollSeconds)},function(t){i(function(){return e.processTemps()},1e3*e.settings.pollSeconds)})},e.changeValue=function(t,r,n){l&&i.cancel(l),n?t.temp[r]++:t.temp[r]--,l=i(function(){t.knob.max=t.temp.target+t.temp.diff,e.updateKnobCopy(t)},1e3)},e.saveArduinoUrl=function(){-1===e.urls.indexOf(e.settings.arduinoUrl)&&(e.urls.push(e.settings.arduinoUrl),u.settings("urls",e.urls))},e.loadConfig().then(e.init).then(e.processTemps),e.$watch("settings",function(e,t){u.settings("settings",e)},!0),e.$watch("kettles",function(e,t){u.settings("kettles",e)},!0)}),angular.module("brewbench").directive("editable",function(){return{restrict:"E",scope:{model:"=",type:"@?",trim:"@?",change:"&?"},replace:!1,template:'<span><input type="{{type}}" ng-model="model" ng-show="edit" ng-enter="edit=false" ng-change="{{change||false}}" class="editable"></input><span class="editable" ng-show="!edit">{{(trim) ? (model | limitTo:trim)+"..." : model}}</span></span>',link:function(e,t,r){e.edit=!1,e.type=e.type?e.type:"text",t.bind("click",function(){e.$apply(e.edit=!0)})}}}).directive("ngEnter",function(){return function(e,t,r){t.bind("keypress",function(t){13!==t.charCode&&13!==t.keyCode||(e.$apply(r.ngEnter),e.change&&e.$apply(e.change))})}}).directive("onReadFile",function(e){return{restrict:"A",scope:!1,link:function(t,r,n){var i=e(n.onReadFile);r.on("change",function(e){var r=new FileReader,n=(e.srcElement||e.target).files[0],a=n.name.split(".").pop().toLowerCase();r.onload=function(e){t.$apply(function(){i(t,{$fileContent:e.target.result,$ext:a})})},r.readAsText(n)})}}}),angular.module("brewbench").filter("moment",function(){return function(e){return e?moment(new Date(e)).fromNow():""}}).filter("formatDegrees",function(e){return function(t,r){return"F"==r?e("toFahrenheit")(t):e("toCelsius")(t)}}).filter("toFahrenheit",function(){return function(e){return Math.round(9*e/5+32)}}).filter("toCelsius",function(){return function(e){return Math.round(5*(e-32)/9)}}),angular.module("brewbench").factory("BrewService",function(e,t,r){return{clear:function(){window.localStorage&&(window.localStorage.removeItem("settings"),window.localStorage.removeItem("kettles"),window.localStorage.removeItem("urls"))},settings:function(e,t){if(!window.localStorage)return t;try{if(t)return window.localStorage.setItem(e,JSON.stringify(t));if(window.localStorage.getItem(e))return JSON.parse(window.localStorage.getItem(e))}catch(e){}return t},sensorTypes:function(e){var t=[{name:"Thermistor",analog:!0},{name:"DS18B20",analog:!1},{name:"PT100",analog:!0}];return e?_.filter(t,{name:e})[0]:t},kettleTypes:function(e){var t=[{name:"Boil",type:"hop",target:200,diff:5},{name:"Mash",type:"grain",target:150,diff:5},{name:"Hot Liquor",type:"water",target:200,diff:5},{name:"Fermenter",type:"fermenter",target:74,diff:2}];return e?_.filter(t,{type:e})[0]:t},byteCount:function(e){return encodeURI(e).split(/%..|./).length-1},domain:function(e){var t=this.settings("settings"),r="";return t&&t.arduinoUrl?r=-1===t.arduinoUrl.indexOf("//")?"//"+t.arduinoUrl:t.arduinoUrl:"localhost"==document.location.host&&(r="//arduino.local"),e&&-1!==r.indexOf("//")?r.substring(r.indexOf("//")+2):r},slack:function(r,n,i,a,o){var u=t.defer(),s={attachments:[{fallback:n,title:o.key+" kettle",title_link:"http://"+document.location.host+"/#/arduino/"+this.domain(!0),fields:[{value:n}],color:i,mrkdwn_in:["text","fallback","fields"],thumb_url:a}]};return e({url:r,method:"POST",data:"payload="+JSON.stringify(s),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){u.resolve(e.data)},function(e){u.reject(e)}),u.promise},temp:function(r){var n=t.defer(),i=this.domain()+"/arduino/"+r.type+"/"+r.pin,a=this.settings("settings");return e({url:i,method:"GET",timeout:1e3*a.pollSeconds,headers:{"Content-Type":"application/json"}}).then(function(e){null==e.headers("X-Sketch-Version")||e.headers("X-Sketch-Version")!=a.sketch_version?n.reject("Sketch Version is out of date.  Please Update. Sketch: "+e.headers("X-Sketch-Version")+" BrewBench: "+a.sketch_version):n.resolve(e.data)},function(e){n.reject(e)}),n.promise},digital:function(r,n){var i=t.defer(),a=this.domain()+"/arduino/digital/"+r+"/"+n,o=this.settings("settings");return e({url:a,method:"GET",timeout:1e3*o.pollSeconds}).then(function(e){null==e.headers("X-Sketch-Version")||e.headers("X-Sketch-Version")!=o.sketch_version?i.reject("Sketch Version is out of date.  Please Update. Sketch: "+e.headers("X-Sketch-Version")+" BrewBench: "+o.sketch_version):i.resolve(e.data)},function(e){i.reject(e)}),i.promise},digitalRead:function(r,n){var i=t.defer(),a=this.domain()+"/arduino/digital/"+r,o=this.settings("settings");return e({url:a,method:"GET",timeout:n||1e3*o.pollSeconds}).then(function(e){null==e.headers("X-Sketch-Version")||e.headers("X-Sketch-Version")!=o.sketch_version?i.reject("Sketch Version is out of date.  Please Update. Sketch: "+e.headers("X-Sketch-Version")+" BrewBench: "+o.sketch_version):i.resolve(e.data)},function(e){i.reject(e)}),i.promise},pkg:function(){var r=t.defer();return e.get("/package.json").then(function(e){r.resolve(e.data)},function(e){r.reject(e)}),r.promise},grains:function(){var r=t.defer();return e.get("/assets/data/grains.json").then(function(e){r.resolve(e.data)},function(e){r.reject(e)}),r.promise},hops:function(){var r=t.defer();return e.get("/assets/data/hops.json").then(function(e){r.resolve(e.data)},function(e){r.reject(e)}),r.promise},water:function(){var r=t.defer();return e.get("/assets/data/water.json").then(function(e){r.resolve(e.data)},function(e){r.reject(e)}),r.promise},lovibond:function(){var r=t.defer();return e.get("/assets/data/lovibond.json").then(function(e){r.resolve(e.data)},function(e){r.reject(e)}),r.promise},chartOptions:function(e){return{chart:{type:"lineChart",noData:"Press play on a kettle to start graphing.",height:350,margin:{top:20,right:20,bottom:100,left:65},x:function(e){return e&&e.length?e[0]:e},y:function(e){return e&&e.length?e[1]:e},color:d3.scale.category10().range(),duration:300,useInteractiveGuideline:!0,clipVoronoi:!1,xAxis:{axisLabel:"Time",tickFormat:function(e){return d3.time.format("%I:%M:%S")(new Date(e))},orient:"bottom",tickPadding:20,axisLabelDistance:40,staggerLabels:!0},forceY:e&&"F"!=e?[-17,104]:[0,220],yAxis:{axisLabel:"Temperature",tickFormat:function(e){return e+"°"},orient:"left",showMaxMin:!0,axisLabelDistance:0}}}},abv:function(e,t){return(131.25*(e-t)).toFixed(2)},abva:function(e,t){return(76.08*(e-t)/(1.775-e)*(t/.794)).toFixed(2)},abw:function(e,t){return(.79*e/t).toFixed(2)},re:function(e,t){return.1808*e+.8192*t},attenuation:function(e,t){return(100*(1-t/e)).toFixed(2)},calories:function(e,t,r){return((6.9*e+4*(t-.1))*r*3.55).toFixed(1)},sg:function(e){var t=(1+e/(258.6-e/258.2*227.1)).toFixed(3);return parseFloat(t)},plato:function(e){var t=(1111.14*e-616.868-630.272*Math.pow(e,2)+135.997*Math.pow(e,3)).toString();return 5==t.substring(t.indexOf(".")+1,t.indexOf(".")+2)?t=t.substring(0,t.indexOf(".")+2):t.substring(t.indexOf(".")+1,t.indexOf(".")+2)<5?t=t.substring(0,t.indexOf(".")):t.substring(t.indexOf(".")+1,t.indexOf(".")+2)>5&&(t=t.substring(0,t.indexOf(".")),t=parseFloat(t)+1),parseFloat(t)},recipeBeerSmith:function(e){var t={name:"",category:"",abv:"",og:0,fg:0,hops:[],grains:[],yeast:[],misc:[]};return e.F_R_NAME&&(t.name=e.F_R_NAME),e.F_R_STYLE.F_S_CATEGORY&&(t.category=e.F_R_STYLE.F_S_CATEGORY),e.F_R_STYLE.F_S_MAX_ABV?t.abv=r("number")(e.F_R_STYLE.F_S_MAX_ABV,2):e.F_R_STYLE.F_S_MIN_ABV&&(t.abv=r("number")(e.F_R_STYLE.F_S_MIN_ABV,2)),e.Ingredients.Data.Grain&&_.each(e.Ingredients.Data.Grain,function(e){t.grains.push({label:e.F_G_NAME,min:parseInt(e.F_G_BOIL_TIME,10),notes:r("number")(e.F_G_AMOUNT/16,2)+" lbs."})}),e.Ingredients.Data.Hops&&_.each(e.Ingredients.Data.Hops,function(e){t.hops.push({label:e.F_H_NAME,min:parseInt(e.F_H_DRY_HOP_TIME,10)>0?null:parseInt(e.F_H_BOIL_TIME,10),notes:parseInt(e.F_H_DRY_HOP_TIME,10)>0?"Dry Hop "+r("number")(e.F_H_AMOUNT,2)+" oz. for "+parseInt(e.F_H_DRY_HOP_TIME,10)+" Days":r("number")(e.F_H_AMOUNT,2)+" oz."})}),e.Ingredients.Data.Misc&&(e.Ingredients.Data.Misc.length?_.each(e.Ingredients.Data.Misc,function(e){t.misc.push({label:e.F_M_NAME+" "+r("number")(e.F_M_AMOUNT,2),min:parseInt(e.F_M_TIME,10)})}):t.misc.push({label:e.Ingredients.Data.Misc.F_M_NAME+" "+r("number")(e.Ingredients.Data.Misc.F_M_AMOUNT,2)+" oz.",min:parseInt(e.Ingredients.Data.Misc.F_M_TIME,10)})),e.Ingredients.Data.Yeast&&(e.Ingredients.Data.Yeast.length?_.each(e.Ingredients.Data.Yeast,function(e){t.yeast.push({name:e.F_Y_LAB+" "+e.F_Y_PRODUCT_ID})}):t.yeast.push({name:e.Ingredients.Data.Yeast.F_Y_LAB+" "+e.Ingredients.Data.Yeast.F_Y_PRODUCT_ID})),t},recipeBeerXML:function(e){var t={name:"",category:"",abv:"",og:0,fg:0,hops:[],grains:[],yeast:[],misc:[]},n=60;return e.NAME&&(t.name=e.NAME),e.STYLE.CATEGORY&&(t.category=e.STYLE.CATEGORY),e.OG&&(t.og=parseFloat(e.OG).toFixed(3)),e.FG&&(t.fg=parseFloat(e.FG).toFixed(3)),e.STYLE.ABV_MAX?t.abv=r("number")(e.STYLE.ABV_MAX,2):e.STYLE.ABV_MIN&&(t.abv=r("number")(e.STYLE.ABV_MIN,2)),e.MASH.MASH_STEPS.MASH_STEP[0].STEP_TIME&&(n=e.MASH.MASH_STEPS.MASH_STEP[0].STEP_TIME),e.FERMENTABLES&&_.each(e.FERMENTABLES.FERMENTABLE,function(e){t.grains.push({label:e.NAME,min:parseInt(n,10),notes:r("number")(e.AMOUNT,2)+" lbs."})}),e.HOPS&&_.each(e.HOPS.HOP,function(e){t.hops.push({label:e.NAME+" ("+e.FORM+")",min:"Dry Hop"==e.USE?0:parseInt(e.TIME,10),notes:"Dry Hop"==e.USE?e.USE+" "+r("number")(1e3*e.AMOUNT/28.3495,2)+" oz. for "+parseInt(e.TIME/60/24,10)+" Days":e.USE+" "+r("number")(1e3*e.AMOUNT/28.3495,2)+" oz."})}),e.MISCS&&_.each(e.MISCS.MISC,function(e){t.hops.push({label:e.NAME,min:parseInt(hop.TIME,10),notes:e.USE})}),e.YEASTS&&(e.YEASTS.YEAST.length?_.each(e.YEASTS.YEAST,function(e){t.yeast.push({name:e.NAME})}):t.yeast.push({name:e.YEASTS.YEAST.NAME})),t},formatXML:function(e){var t=[{f:"&Ccedil;",r:"Ç"},{f:"&ccedil;",r:"ç"},{f:"&Euml;",r:"Ë"},{f:"&euml;",r:"ë"},{f:"&#262;",r:"Ć"},{f:"&#263;",r:"ć"},{f:"&#268;",r:"Č"},{f:"&#269;",r:"č"},{f:"&#272;",r:"Đ"},{f:"&#273;",r:"đ"},{f:"&#352;",r:"Š"},{f:"&#353;",r:"š"},{f:"&#381;",r:"Ž"},{f:"&#382;",r:"ž"},{f:"&Agrave;",r:"À"},{f:"&agrave;",r:"à"},{f:"&Ccedil;",r:"Ç"},{f:"&ccedil;",r:"ç"},{f:"&Egrave;",r:"È"},{f:"&egrave;",r:"è"},{f:"&Eacute;",r:"É"},{f:"&eacute;",r:"é"},{f:"&Iacute;",r:"Í"},{f:"&iacute;",r:"í"},{f:"&Iuml;",r:"Ï"},{f:"&iuml;",r:"ï"},{f:"&Ograve;",r:"Ò"},{f:"&ograve;",r:"ò"},{f:"&Oacute;",r:"Ó"},{f:"&oacute;",r:"ó"},{f:"&Uacute;",r:"Ú"},{f:"&uacute;",r:"ú"},{f:"&Uuml;",r:"Ü"},{f:"&uuml;",r:"ü"},{f:"&middot;",r:"·"},{f:"&#262;",r:"Ć"},{f:"&#263;",r:"ć"},{f:"&#268;",r:"Č"},{f:"&#269;",r:"č"},{f:"&#272;",r:"Đ"},{f:"&#273;",r:"đ"},{f:"&#352;",r:"Š"},{f:"&#353;",r:"š"},{f:"&#381;",r:"Ž"},{f:"&#382;",r:"ž"},{f:"&Aacute;",r:"Á"},{f:"&aacute;",r:"á"},{f:"&#268;",r:"Č"},{f:"&#269;",r:"č"},{f:"&#270;",r:"Ď"},{f:"&#271;",r:"ď"},{f:"&Eacute;",r:"É"},{f:"&eacute;",r:"é"},{f:"&#282;",r:"Ě"},{f:"&#283;",r:"ě"},{f:"&Iacute;",r:"Í"},{f:"&iacute;",r:"í"},{f:"&#327;",r:"Ň"},{f:"&#328;",r:"ň"},{f:"&Oacute;",r:"Ó"},{f:"&oacute;",r:"ó"},{f:"&#344;",r:"Ř"},{f:"&#345;",r:"ř"},{f:"&#352;",r:"Š"},{f:"&#353;",r:"š"},{f:"&#356;",r:"Ť"},{f:"&#357;",r:"ť"},{f:"&Uacute;",r:"Ú"},{f:"&uacute;",r:"ú"},{f:"&#366;",r:"Ů"},{f:"&#367;",r:"ů"},{f:"&Yacute;",r:"Ý"},{f:"&yacute;",r:"ý"},{f:"&#381;",r:"Ž"},{f:"&#382;",r:"ž"},{f:"&AElig;",r:"Æ"},{f:"&aelig;",r:"æ"},{f:"&Oslash;",r:"Ø"},{f:"&oslash;",r:"ø"},{f:"&Aring;",r:"Å"},{f:"&aring;",r:"å"},{f:"&Eacute;",r:"É"},{f:"&eacute;",r:"é"},{f:"&Euml;",r:"Ë"},{f:"&euml;",r:"ë"},{f:"&Iuml;",r:"Ï"},{f:"&iuml;",r:"ï"},{f:"&Oacute;",r:"Ó"},{f:"&oacute;",r:"ó"},{f:"&#264;",r:"Ĉ"},{f:"&#265;",r:"ĉ"},{f:"&#284;",r:"Ĝ"},{f:"&#285;",r:"ĝ"},{f:"&#292;",r:"Ĥ"},{f:"&#293;",r:"ĥ"},{f:"&#308;",r:"Ĵ"},{f:"&#309;",r:"ĵ"},{f:"&#348;",r:"Ŝ"},{f:"&#349;",r:"ŝ"},{f:"&#364;",r:"Ŭ"},{f:"&#365;",r:"ŭ"},{f:"&Auml;",r:"Ä"},{f:"&auml;",r:"ä"},{f:"&Ouml;",r:"Ö"},{f:"&ouml;",r:"ö"},{f:"&Otilde;",r:"Õ"},{f:"&otilde;",r:"õ"},{f:"&Uuml;",r:"Ü"},{f:"&uuml;",r:"ü"},{f:"&Aacute;",r:"Á"},{f:"&aacute;",r:"á"},{f:"&ETH;",r:"Ð"},{f:"&eth;",r:"ð"},{f:"&Iacute;",r:"Í"},{f:"&iacute;",r:"í"},{f:"&Oacute;",r:"Ó"},{f:"&oacute;",r:"ó"},{f:"&Uacute;",r:"Ú"},{f:"&uacute;",r:"ú"},{f:"&Yacute;",r:"Ý"},{f:"&yacute;",r:"ý"},{f:"&AElig;",r:"Æ"},{f:"&aelig;",r:"æ"},{f:"&Oslash;",r:"Ø"},{f:"&oslash;",r:"ø"},{f:"&Auml;",r:"Ä"},{f:"&auml;",r:"ä"},{f:"&Ouml;",r:"Ö"},{f:"&ouml;",r:"ö"},{f:"&Agrave;",r:"À"},{f:"&agrave;",r:"à"},{f:"&Acirc;",r:"Â"},{f:"&acirc;",r:"â"},{f:"&Ccedil;",r:"Ç"},{f:"&ccedil;",r:"ç"},{f:"&Egrave;",r:"È"},{f:"&egrave;",r:"è"},{f:"&Eacute;",r:"É"},{f:"&eacute;",r:"é"},{f:"&Ecirc;",r:"Ê"},{f:"&ecirc;",r:"ê"},{f:"&Euml;",r:"Ë"},{f:"&euml;",r:"ë"},{f:"&Icirc;",r:"Î"},{f:"&icirc;",r:"î"},{f:"&Iuml;",r:"Ï"},{f:"&iuml;",r:"ï"},{f:"&Ocirc;",r:"Ô"},{f:"&ocirc;",r:"ô"},{f:"&OElig;",r:"Œ"},{f:"&oelig;",r:"œ"},{f:"&Ugrave;",r:"Ù"},{f:"&ugrave;",r:"ù"},{f:"&Ucirc;",r:"Û"},{f:"&ucirc;",r:"û"},{f:"&Uuml;",r:"Ü"},{f:"&uuml;",r:"ü"},{f:"&#376;",r:"Ÿ"},{f:"&yuml;",r:"ÿ"},{f:"&Auml;",r:"Ä"},{f:"&auml;",r:"ä"},{f:"&Ouml;",r:"Ö"},{f:"&ouml;",r:"ö"},{f:"&Uuml;",r:"Ü"},{f:"&uuml;",r:"ü"},{f:"&szlig;",r:"ß"},{f:"&Aacute;",r:"Á"},{f:"&aacute;",r:"á"},{f:"&Acirc;",r:"Â"},{f:"&acirc;",r:"â"},{f:"&Atilde;",r:"Ã"},{f:"&atilde;",r:"ã"},{f:"&Iacute;",r:"Í"},{f:"&iacute;",r:"í"},{f:"&Icirc;",r:"Î"},{f:"&icirc;",r:"î"},{f:"&#296;",r:"Ĩ"},{f:"&#297;",r:"ĩ"},{f:"&Uacute;",r:"Ú"},{f:"&ugrave;",r:"ù"},{f:"&Ucirc;",r:"Û"},{f:"&ucirc;",r:"û"},{f:"&#360;",r:"Ũ"},{f:"&#361;",r:"ũ"},{f:"&#312;",r:"ĸ"},{f:"&Aacute;",r:"Á"},{f:"&aacute;",r:"á"},{f:"&Eacute;",r:"É"},{f:"&eacute;",r:"é"},{f:"&Iacute;",r:"Í"},{f:"&iacute;",r:"í"},{f:"&Oacute;",r:"Ó"},{f:"&oacute;",r:"ó"},{f:"&Ouml;",r:"Ö"},{f:"&ouml;",r:"ö"},{f:"&#336;",r:"Ő"},{f:"&#337;",r:"ő"},{f:"&Uacute;",r:"Ú"},{f:"&uacute;",r:"ú"},{f:"&Uuml;",r:"Ü"},{f:"&uuml;",r:"ü"},{f:"&#368;",r:"Ű"},{f:"&#369;",r:"ű"},{f:"&Aacute;",r:"Á"},{f:"&aacute;",r:"á"},{f:"&ETH;",r:"Ð"},{f:"&eth;",r:"ð"},{f:"&Eacute;",r:"É"},{f:"&eacute;",r:"é"},{f:"&Iacute;",r:"Í"},{f:"&iacute;",r:"í"},{f:"&Oacute;",r:"Ó"},{f:"&oacute;",r:"ó"},{f:"&Uacute;",r:"Ú"},{f:"&uacute;",r:"ú"},{f:"&Yacute;",r:"Ý"},{f:"&yacute;",r:"ý"},{f:"&THORN;",r:"Þ"},{f:"&thorn;",r:"þ"},{f:"&AElig;",r:"Æ"},{f:"&aelig;",r:"æ"},{f:"&Ouml;",r:"Ö"},{f:"&uml;",r:"ö"},{f:"&Aacute;",r:"Á"},{f:"&aacute;",r:"á"},{f:"&Eacute;",r:"É"},{f:"&eacute;",r:"é"},{f:"&Iacute;",r:"Í"},{f:"&iacute;",r:"í"},{f:"&Oacute;",r:"Ó"},{f:"&oacute;",r:"ó"},{f:"&Uacute;",r:"Ú"},{f:"&uacute;",r:"ú"},{f:"&Agrave;",r:"À"},{f:"&agrave;",r:"à"},{f:"&Acirc;",r:"Â"},{f:"&acirc;",r:"â"},{f:"&Egrave;",r:"È"},{f:"&egrave;",r:"è"},{f:"&Eacute;",r:"É"},{f:"&eacute;",r:"é"},{f:"&Ecirc;",r:"Ê"},{f:"&ecirc;",r:"ê"},{f:"&Igrave;",r:"Ì"},{f:"&igrave;",r:"ì"},{f:"&Iacute;",r:"Í"},{f:"&iacute;",r:"í"},{f:"&Icirc;",r:"Î"},{f:"&icirc;",r:"î"},{f:"&Iuml;",r:"Ï"},{f:"&iuml;",r:"ï"},{f:"&Ograve;",r:"Ò"},{f:"&ograve;",r:"ò"},{f:"&Ocirc;",r:"Ô"},{f:"&ocirc;",r:"ô"},{f:"&Ugrave;",r:"Ù"},{f:"&ugrave;",r:"ù"},{f:"&Ucirc;",r:"Û"},{f:"&ucirc;",r:"û"},{f:"&#256;",r:"Ā"},{f:"&#257;",r:"ā"},{f:"&#268;",r:"Č"},{f:"&#269;",r:"č"},{f:"&#274;",r:"Ē"},{f:"&#275;",r:"ē"},{f:"&#290;",r:"Ģ"},{f:"&#291;",r:"ģ"},{f:"&#298;",r:"Ī"},{f:"&#299;",r:"ī"},{f:"&#310;",r:"Ķ"},{f:"&#311;",r:"ķ"},{f:"&#315;",r:"Ļ"},{f:"&#316;",r:"ļ"},{f:"&#325;",r:"Ņ"},{f:"&#326;",r:"ņ"},{f:"&#342;",r:"Ŗ"},{f:"&#343;",r:"ŗ"},{f:"&#352;",r:"Š"},{f:"&#353;",r:"š"},{f:"&#362;",r:"Ū"},{f:"&#363;",r:"ū"},{f:"&#381;",r:"Ž"},{f:"&#382;",r:"ž"},{f:"&AElig;",r:"Æ"},{f:"&aelig;",r:"æ"},{f:"&Oslash;",r:"Ø"},{f:"&oslash;",r:"ø"},{f:"&Aring;",r:"Å"},{f:"&aring;",r:"å"},{f:"&#260;",
r:"Ą"},{f:"&#261;",r:"ą"},{f:"&#262;",r:"Ć"},{f:"&#263;",r:"ć"},{f:"&#280;",r:"Ę"},{f:"&#281;",r:"ę"},{f:"&#321;",r:"Ł"},{f:"&#322;",r:"ł"},{f:"&#323;",r:"Ń"},{f:"&#324;",r:"ń"},{f:"&Oacute;",r:"Ó"},{f:"&oacute;",r:"ó"},{f:"&#346;",r:"Ś"},{f:"&#347;",r:"ś"},{f:"&#377;",r:"Ź"},{f:"&#378;",r:"ź"},{f:"&#379;",r:"Ż"},{f:"&#380;",r:"ż"},{f:"&Agrave;",r:"À"},{f:"&agrave;",r:"à"},{f:"&Aacute;",r:"Á"},{f:"&aacute;",r:"á"},{f:"&Acirc;",r:"Â"},{f:"&acirc;",r:"â"},{f:"&Atilde;",r:"Ã"},{f:"&atilde;",r:"ã"},{f:"&Ccedil;",r:"Ç"},{f:"&ccedil;",r:"ç"},{f:"&Egrave;",r:"È"},{f:"&egrave;",r:"è"},{f:"&Eacute;",r:"É"},{f:"&eacute;",r:"é"},{f:"&Ecirc;",r:"Ê"},{f:"&ecirc;",r:"ê"},{f:"&Igrave;",r:"Ì"},{f:"&igrave;",r:"ì"},{f:"&Iacute;",r:"Í"},{f:"&iacute;",r:"í"},{f:"&Iuml;",r:"Ï"},{f:"&iuml;",r:"ï"},{f:"&Ograve;",r:"Ò"},{f:"&ograve;",r:"ò"},{f:"&Oacute;",r:"Ó"},{f:"&oacute;",r:"ó"},{f:"&Otilde;",r:"Õ"},{f:"&otilde;",r:"õ"},{f:"&Ugrave;",r:"Ù"},{f:"&ugrave;",r:"ù"},{f:"&Uacute;",r:"Ú"},{f:"&uacute;",r:"ú"},{f:"&Uuml;",r:"Ü"},{f:"&uuml;",r:"ü"},{f:"&ordf;",r:"ª"},{f:"&ordm;",r:"º"},{f:"&#258;",r:"Ă"},{f:"&#259;",r:"ă"},{f:"&Acirc;",r:"Â"},{f:"&acirc;",r:"â"},{f:"&Icirc;",r:"Î"},{f:"&icirc;",r:"î"},{f:"&#350;",r:"Ş"},{f:"&#351;",r:"ş"},{f:"&#354;",r:"Ţ"},{f:"&#355;",r:"ţ"},{f:"&Aacute;",r:"Á"},{f:"&aacute;",r:"á"},{f:"&#268;",r:"Č"},{f:"&#269;",r:"č"},{f:"&#272;",r:"Đ"},{f:"&#273;",r:"đ"},{f:"&#330;",r:"Ŋ"},{f:"&#331;",r:"ŋ"},{f:"&#352;",r:"Š"},{f:"&#353;",r:"š"},{f:"&#358;",r:"Ŧ"},{f:"&#359;",r:"ŧ"},{f:"&#381;",r:"Ž"},{f:"&#382;",r:"ž"},{f:"&Agrave;",r:"À"},{f:"&agrave;",r:"à"},{f:"&Egrave;",r:"È"},{f:"&egrave;",r:"è"},{f:"&Eacute;",r:"É"},{f:"&eacute;",r:"é"},{f:"&Igrave;",r:"Ì"},{f:"&igrave;",r:"ì"},{f:"&Ograve;",r:"Ò"},{f:"&ograve;",r:"ò"},{f:"&Oacute;",r:"Ó"},{f:"&oacute;",r:"ó"},{f:"&Ugrave;",r:"Ù"},{f:"&ugrave;",r:"ù"},{f:"&Aacute;",r:"Á"},{f:"&aacute;",r:"á"},{f:"&Auml;",r:"Ä"},{f:"&auml;",r:"ä"},{f:"&#268;",r:"Č"},{f:"&#269;",r:"č"},{f:"&#270;",r:"Ď"},{f:"&#271;",r:"ď"},{f:"&Eacute;",r:"É"},{f:"&eacute;",r:"é"},{f:"&#313;",r:"Ĺ"},{f:"&#314;",r:"ĺ"},{f:"&#317;",r:"Ľ"},{f:"&#318;",r:"ľ"},{f:"&#327;",r:"Ň"},{f:"&#328;",r:"ň"},{f:"&Oacute;",r:"Ó"},{f:"&oacute;",r:"ó"},{f:"&Ocirc;",r:"Ô"},{f:"&ocirc;",r:"ô"},{f:"&#340;",r:"Ŕ"},{f:"&#341;",r:"ŕ"},{f:"&#352;",r:"Š"},{f:"&#353;",r:"š"},{f:"&#356;",r:"Ť"},{f:"&#357;",r:"ť"},{f:"&Uacute;",r:"Ú"},{f:"&uacute;",r:"ú"},{f:"&Yacute;",r:"Ý"},{f:"&yacute;",r:"ý"},{f:"&#381;",r:"Ž"},{f:"&#382;",r:"ž"},{f:"&#268;",r:"Č"},{f:"&#269;",r:"č"},{f:"&#352;",r:"Š"},{f:"&#353;",r:"š"},{f:"&#381;",r:"Ž"},{f:"&#382;",r:"ž"},{f:"&Aacute;",r:"Á"},{f:"&aacute;",r:"á"},{f:"&Eacute;",r:"É"},{f:"&eacute;",r:"é"},{f:"&Iacute;",r:"Í"},{f:"&iacute;",r:"í"},{f:"&Oacute;",r:"Ó"},{f:"&oacute;",r:"ó"},{f:"&Ntilde;",r:"Ñ"},{f:"&ntilde;",r:"ñ"},{f:"&Uacute;",r:"Ú"},{f:"&uacute;",r:"ú"},{f:"&Uuml;",r:"Ü"},{f:"&uuml;",r:"ü"},{f:"&iexcl;",r:"¡"},{f:"&ordf;",r:"ª"},{f:"&iquest;",r:"¿"},{f:"&ordm;",r:"º"},{f:"&Aring;",r:"Å"},{f:"&aring;",r:"å"},{f:"&Auml;",r:"Ä"},{f:"&auml;",r:"ä"},{f:"&Ouml;",r:"Ö"},{f:"&ouml;",r:"ö"},{f:"&Ccedil;",r:"Ç"},{f:"&ccedil;",r:"ç"},{f:"&#286;",r:"Ğ"},{f:"&#287;",r:"ğ"},{f:"&#304;",r:"İ"},{f:"&#305;",r:"ı"},{f:"&Ouml;",r:"Ö"},{f:"&ouml;",r:"ö"},{f:"&#350;",r:"Ş"},{f:"&#351;",r:"ş"},{f:"&Uuml;",r:"Ü"},{f:"&uuml;",r:"ü"},{f:"&euro;",r:"€"},{f:"&pound;",r:"£"},{f:"&laquo;",r:"«"},{f:"&raquo;",r:"»"},{f:"&bull;",r:"•"},{f:"&dagger;",r:"†"},{f:"&copy;",r:"©"},{f:"&reg;",r:"®"},{f:"&trade;",r:"™"},{f:"&deg;",r:"°"},{f:"&permil;",r:"‰"},{f:"&micro;",r:"µ"},{f:"&middot;",r:"·"},{f:"&ndash;",r:"–"},{f:"&mdash;",r:"—"},{f:"&#8470;",r:"№"},{f:"&reg;",r:"®"},{f:"&para;",r:"¶"},{f:"&plusmn;",r:"±"},{f:"&middot;",r:"·"},{f:"less-t",r:"<"},{f:"greater-t",r:">"},{f:"&not;",r:"¬"},{f:"&curren;",r:"¤"},{f:"&brvbar;",r:"¦"},{f:"&deg;",r:"°"},{f:"&acute;",r:"´"},{f:"&uml;",r:"¨"},{f:"&macr;",r:"¯"},{f:"&cedil;",r:"¸"},{f:"&laquo;",r:"«"},{f:"&raquo;",r:"»"},{f:"&sup1;",r:"¹"},{f:"&sup2;",r:"²"},{f:"&sup3;",r:"³"},{f:"&ordf;",r:"ª"},{f:"&ordm;",r:"º"},{f:"&iexcl;",r:"¡"},{f:"&iquest;",r:"¿"},{f:"&micro;",r:"µ"},{f:"hy;\t",r:"&"},{f:"&ETH;",r:"Ð"},{f:"&eth;",r:"ð"},{f:"&Ntilde;",r:"Ñ"},{f:"&ntilde;",r:"ñ"},{f:"&Oslash;",r:"Ø"},{f:"&oslash;",r:"ø"},{f:"&szlig;",r:"ß"},{f:"&amp;",r:"and"},{f:"&ldquo;",r:'"'},{f:"&rdquo;",r:'"'},{f:"&rsquo;",r:"'"}];return _.each(t,function(t){-1!==e.indexOf(t.f)&&(e=e.replace(RegExp(t.f,"g"),t.r))}),e}}});