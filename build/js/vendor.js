"use strict";!function(){var t={},e=function(t,e,i){this.element=t,this.value=e,this.options=i,this.inDrag=!1};e.prototype.valueToRadians=function(t,e,i,n,o){return e=e||100,o=o||0,i=i||360,n=n||0,Math.PI/180*((t-o)*(i-n)/(e-o)+n)},e.prototype.radiansToValue=function(t,e,i,n,o){return e=e||100,i=i||0,n=n||360,o=o||0,(180/Math.PI*t-o)*(e-i)/(n-o)+i},e.prototype.createArc=function(t,e,i,n,o){return d3.svg.arc().innerRadius(t).outerRadius(e).startAngle(i).endAngle(n).cornerRadius(o)},e.prototype.drawArc=function(t,e,i,n,o,s){var r=t.append("path").attr("id",i).attr("d",e).style(n).attr("transform","translate("+this.options.size/2+", "+this.options.size/2+")");return!1===this.options.readOnly&&(o&&r.on("click",o),s&&r.call(s)),r},e.prototype.createArcs=function(){var t=parseInt(this.options.size/2,10),e=this.valueToRadians(this.options.startAngle,360),i=this.valueToRadians(this.options.endAngle,360);this.options.scale.enabled&&(t-=this.options.scale.width+this.options.scale.spaceWidth);var n,o=t-this.options.trackWidth,s=t-this.options.barWidth,r=t-this.options.barWidth,a=t,l=t,c=t,p=t;this.options.barWidth>this.options.trackWidth?(n=(this.options.barWidth-this.options.trackWidth)/2,o-=n,a-=n):this.options.barWidth<this.options.trackWidth&&(n=(this.options.trackWidth-this.options.barWidth)/2,l-=n,c-=n,s-=n,r-=n),this.options.bgColor&&(this.bgArc=this.createArc(0,t,e,i)),"tron"===this.options.skin.type&&(a=a-this.options.skin.width-this.options.skin.spaceWidth,l=l-this.options.skin.width-this.options.skin.spaceWidth,c=c-this.options.skin.width-this.options.skin.spaceWidth,p=p-this.options.skin.width-this.options.skin.spaceWidth,this.hoopArc=this.createArc(t-this.options.skin.width,t,e,i)),this.trackArc=this.createArc(o,a,e,i),this.changeArc=this.createArc(s,l,e,e,this.options.barCap),this.valueArc=this.createArc(r,c,e,e,this.options.barCap),this.interactArc=this.createArc(1,p,e,i)},e.prototype.drawArcs=function(t,e){var i=d3.select(this.element).append("svg").attr("width",this.options.size).attr("height",this.options.size);if(this.options.bgColor&&this.drawArc(i,this.bgArc,"bgArc",{fill:this.options.bgColor}),this.options.displayInput){var n=.2*this.options.size+"px";"auto"!==this.options.fontSize&&(n=this.options.fontSize+"px"),this.options.step<1&&(this.value=this.value.toFixed(1));var o=this.value;"function"==typeof this.options.inputFormatter&&(o=this.options.inputFormatter(o)),i.append("text").attr("id","text").attr("text-anchor","middle").attr("font-size",n).style("fill",this.options.textColor).text(o+this.options.unit||"").attr("transform","translate("+this.options.size/2+", "+(this.options.size/2+.06*this.options.size)+")"),this.options.subText.enabled&&(n=.07*this.options.size+"px","auto"!==this.options.subText.font&&(n=this.options.subText.font+"px"),i.append("text").attr("class","sub-text").attr("text-anchor","middle").attr("font-size",n).style("fill",this.options.subText.color).text(this.options.subText.text).attr("transform","translate("+this.options.size/2+", "+(this.options.size/2+.15*this.options.size)+")"))}if(this.options.scale.enabled){var s,r,a,l=0,c=0,p=this.valueToRadians(this.options.min,this.options.max,this.options.endAngle,this.options.startAngle,this.options.min),u=this.valueToRadians(this.options.max,this.options.max,this.options.endAngle,this.options.startAngle,this.options.min),h=0;if(0===this.options.startAngle&&360===this.options.endAngle||(h=1),"dots"===this.options.scale.type){var d=this.options.scale.width;s=this.options.size/2-d,r=this.options.scale.quantity;var f=s+this.options.scale.width;a=d3.range(r).map(function(){return c=l*(u-p)-Math.PI/2+p,l+=1/(r-h),{cx:f+Math.cos(c)*s,cy:f+Math.sin(c)*s,r:d}}),i.selectAll("circle").data(a).enter().append("circle").attr({r:function(t){return t.r},cx:function(t){return t.cx},cy:function(t){return t.cy},fill:this.options.scale.color})}else if("lines"===this.options.scale.type){var v=this.options.scale.height;s=this.options.size/2,r=this.options.scale.quantity,a=d3.range(r).map(function(){return c=l*(u-p)-Math.PI/2+p,l+=1/(r-h),{x1:s+Math.cos(c)*s,y1:s+Math.sin(c)*s,x2:s+Math.cos(c)*(s-v),y2:s+Math.sin(c)*(s-v)}}),i.selectAll("line").data(a).enter().append("line").attr({x1:function(t){return t.x1},y1:function(t){return t.y1},x2:function(t){return t.x2},y2:function(t){return t.y2},"stroke-width":this.options.scale.width,stroke:this.options.scale.color})}}"tron"===this.options.skin.type&&this.drawArc(i,this.hoopArc,"hoopArc",{fill:this.options.skin.color}),this.drawArc(i,this.trackArc,"trackArc",{fill:this.options.trackColor}),this.options.displayPrevious?this.changeElem=this.drawArc(i,this.changeArc,"changeArc",{fill:this.options.prevBarColor}):this.changeElem=this.drawArc(i,this.changeArc,"changeArc",{"fill-opacity":0}),this.valueElem=this.drawArc(i,this.valueArc,"valueArc",{fill:this.options.barColor});var g="pointer";this.options.readOnly&&(g="default"),this.drawArc(i,this.interactArc,"interactArc",{"fill-opacity":0,cursor:g},t,e)},e.prototype.draw=function(t){function e(){o.inDrag=!0,n(d3.event.x-o.options.size/2,d3.event.y-o.options.size/2,!1)}function i(){o.inDrag=!1;var t=d3.mouse(this.parentNode);n(t[0]-o.options.size/2,t[1]-o.options.size/2,!0)}function n(e,i,n){var s,r,a=Math.atan(i/e)/(Math.PI/180);if(e>=0&&0>=i||e>=0&&i>=0?r=90:(r=270,o.options.startAngle<0&&(r=-90)),s=(r+a)*(Math.PI/180),o.value=o.radiansToValue(s,o.options.max,o.options.min,o.options.endAngle,o.options.startAngle),o.value>=o.options.min&&o.value<=o.options.max&&(o.value=Math.round(~~((o.value<0?-.5:.5)+o.value/o.options.step)*o.options.step*100)/100,o.options.step<1&&(o.value=o.value.toFixed(1)),t(o.value),o.valueArc.endAngle(o.valueToRadians(o.value,o.options.max,o.options.endAngle,o.options.startAngle,o.options.min)),o.valueElem.attr("d",o.valueArc),n&&(o.changeArc.endAngle(o.valueToRadians(o.value,o.options.max,o.options.endAngle,o.options.startAngle,o.options.min)),o.changeElem.attr("d",o.changeArc)),o.options.displayInput)){var l=o.value;"function"==typeof o.options.inputFormatter&&(l=o.options.inputFormatter(l)),d3.select(o.element).select("#text").text(l+o.options.unit||"")}}d3.select(this.element).select("svg").remove();var o=this;o.createArcs();var s=d3.behavior.drag().on("drag",e).on("dragend",i);o.drawArcs(i,s),o.options.animate.enabled?o.valueElem.transition().ease(o.options.animate.ease).duration(o.options.animate.duration).tween("",function(){var t=d3.interpolate(o.valueToRadians(o.options.startAngle,360),o.valueToRadians(o.value,o.options.max,o.options.endAngle,o.options.startAngle,o.options.min));return function(e){var i=t(e);o.valueElem.attr("d",o.valueArc.endAngle(i)),o.changeElem.attr("d",o.changeArc.endAngle(i))}}):(o.changeArc.endAngle(this.valueToRadians(this.value,this.options.max,this.options.endAngle,this.options.startAngle,this.options.min)),o.changeElem.attr("d",o.changeArc),o.valueArc.endAngle(this.valueToRadians(this.value,this.options.max,this.options.endAngle,this.options.startAngle,this.options.min)),o.valueElem.attr("d",o.valueArc))},e.prototype.setValue=function(t){if(!this.inDrag&&this.value>=this.options.min&&this.value<=this.options.max){var e=this.valueToRadians(t,this.options.max,this.options.endAngle,this.options.startAngle,this.options.min);if(this.value=Math.round(~~((0>t?-.5:.5)+t/this.options.step)*this.options.step*100)/100,this.options.step<1&&(this.value=this.value.toFixed(1)),this.changeArc.endAngle(e),d3.select(this.element).select("#changeArc").attr("d",this.changeArc),this.valueArc.endAngle(e),d3.select(this.element).select("#valueArc").attr("d",this.valueArc),this.options.displayInput){var i=this.value;"function"==typeof this.options.inputFormatter&&(i=this.options.inputFormatter(i)),d3.select(this.element).select("#text").text(i+this.options.unit||"")}}},t.Knob=e,t.knobDirective=function(){return{restrict:"E",scope:{value:"=",options:"="},link:function(e,i){e.value=e.value||0;var n={skin:{type:"simple",width:10,color:"rgba(255,0,0,.5)",spaceWidth:5},animate:{enabled:!0,duration:1e3,ease:"bounce"},size:200,startAngle:0,endAngle:360,unit:"",displayInput:!0,inputFormatter:function(t){return t},readOnly:!1,trackWidth:50,barWidth:50,trackColor:"rgba(0,0,0,0)",barColor:"rgba(255,0,0,.5)",prevBarColor:"rgba(0,0,0,0)",textColor:"#222",barCap:0,fontSize:"auto",subText:{enabled:!1,text:"",color:"gray",font:"auto"},bgColor:"",scale:{enabled:!1,type:"lines",color:"gray",width:4,quantity:20,height:10,spaceWidth:15},step:1,displayPrevious:!1,min:0,max:100,dynamicOptions:!1};e.options=angular.merge(n,e.options);var o=new t.Knob(i[0],e.value,e.options);if(e.$watch("value",function(t,e){null===t&&void 0===t||void 0===e||t===e||o.setValue(t)}),e.options.dynamicOptions){var s=!0;e.$watch("options",function(){if(s)s=!1;else{var a=angular.merge(n,e.options);o=new t.Knob(i[0],e.value,a),r()}},!0)}var r=function(){o.draw(function(t){e.$apply(function(){e.value=t})})};r()}}},angular.module("ui.knob",[]).directive("uiKnob",t.knobDirective)}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=e():t.X2JS=e()}(void 0,function(){return function(t){function e(t){var e=t.localName;return null==e&&(e=t.baseName),null!=e&&""!=e||(e=t.nodeName),e}function i(t){return t.prefix}function n(t){return"string"==typeof t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):t}function o(t,e,i,n){for(var o=0;o<t.length;o++){var s=t[o];if("string"==typeof s){if(s==n)break}else if(s instanceof RegExp){if(s.test(n))break}else if("function"==typeof s&&s(e,i,n))break}return o!=t.length}function s(e,i,n){switch(t.arrayAccessForm){case"property":e[i]instanceof Array?e[i+"_asArray"]=e[i]:e[i+"_asArray"]=[e[i]]}!(e[i]instanceof Array)&&t.arrayAccessFormPaths.length>0&&o(t.arrayAccessFormPaths,e,i,n)&&(e[i]=[e[i]])}function r(t){var e=t.split(/[-T:+Z]/g),i=new Date(e[0],e[1]-1,e[2]),n=e[5].split(".");if(i.setHours(e[3],e[4],n[0]),n.length>1&&i.setMilliseconds(n[1]),e[6]&&e[7]){var o=60*e[6]+Number(e[7]);o=0+("-"==(/\d\d-\d\d:\d\d$/.test(t)?"-":"+")?-1*o:o),i.setMinutes(i.getMinutes()-o-i.getTimezoneOffset())}else-1!==t.indexOf("Z",t.length-1)&&(i=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds())));return i}function a(e,i,n){if(t.datetimeAccessFormPaths.length>0){var s=n.split(".#")[0];return o(t.datetimeAccessFormPaths,e,i,s)?r(e):e}return e}function l(e,i,n,s){return!(i==b.ELEMENT_NODE&&t.xmlElementsFilter.length>0)||o(t.xmlElementsFilter,e,n,s)}function c(n,o){if(n.nodeType==b.DOCUMENT_NODE){for(var r=new Object,p=n.childNodes,u=0;u<p.length;u++){var h=p.item(u);if(h.nodeType==b.ELEMENT_NODE){var d=e(h);r[d]=c(h,d)}}return r}if(n.nodeType==b.ELEMENT_NODE){var r=new Object;r.__cnt=0;for(var p=n.childNodes,u=0;u<p.length;u++){var h=p.item(u),d=e(h);if(h.nodeType!=b.COMMENT_NODE){var f=o+"."+d;l(r,h.nodeType,d,f)&&(r.__cnt++,null==r[d]?(r[d]=c(h,f),s(r,d,f)):(null!=r[d]&&(r[d]instanceof Array||(r[d]=[r[d]],s(r,d,f))),r[d][r[d].length]=c(h,f)))}}for(var v=0;v<n.attributes.length;v++){var g=n.attributes.item(v);r.__cnt++,r[t.attributePrefix+g.name]=g.value}var m=i(n);return null!=m&&""!=m&&(r.__cnt++,r.__prefix=m),null!=r["#text"]&&(r.__text=r["#text"],r.__text instanceof Array&&(r.__text=r.__text.join("\n")),t.stripWhitespaces&&(r.__text=r.__text.trim()),delete r["#text"],"property"==t.arrayAccessForm&&delete r["#text_asArray"],r.__text=a(r.__text,d,o+"."+d)),null!=r["#cdata-section"]&&(r.__cdata=r["#cdata-section"],delete r["#cdata-section"],"property"==t.arrayAccessForm&&delete r["#cdata-section_asArray"]),0==r.__cnt&&"text"==t.emptyNodeForm?r="":1==r.__cnt&&null!=r.__text?r=r.__text:1!=r.__cnt||null==r.__cdata||t.keepCData?r.__cnt>1&&null!=r.__text&&t.skipEmptyTextNodesForObj&&(t.stripWhitespaces&&""==r.__text||""==r.__text.trim())&&delete r.__text:r=r.__cdata,delete r.__cnt,!t.enableToStringFunc||null==r.__text&&null==r.__cdata||(r.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),r}if(n.nodeType==b.TEXT_NODE||n.nodeType==b.CDATA_SECTION_NODE)return n.nodeValue}function p(e,i,o,s){var r="<"+(null!=e&&null!=e.__prefix?e.__prefix+":":"")+i;if(null!=o)for(var a=0;a<o.length;a++){var l=o[a],c=e[l];t.escapeMode&&(c=n(c)),r+=" "+l.substr(t.attributePrefix.length)+"=",t.useDoubleQuotes?r+='"'+c+'"':r+="'"+c+"'"}return r+=s?"/>":">"}function u(t,e){return"</"+(null!=t.__prefix?t.__prefix+":":"")+e+">"}function h(t,e){return-1!==t.indexOf(e,t.length-e.length)}function d(e,i){return!!("property"==t.arrayAccessForm&&h(i.toString(),"_asArray")||0==i.toString().indexOf(t.attributePrefix)||0==i.toString().indexOf("__")||e[i]instanceof Function)}function f(t){var e=0;if(t instanceof Object)for(var i in t)d(t,i)||e++;return e}function v(e,i,n){return 0==t.jsonPropertiesFilter.length||""==n||o(t.jsonPropertiesFilter,e,i,n)}function g(e){var i=[];if(e instanceof Object)for(var n in e)-1==n.toString().indexOf("__")&&0==n.toString().indexOf(t.attributePrefix)&&i.push(n);return i}function m(e){var i="";return null!=e.__cdata&&(i+="<![CDATA["+e.__cdata+"]]>"),null!=e.__text&&(t.escapeMode?i+=n(e.__text):i+=e.__text),i}function A(e){var i="";return e instanceof Object?i+=m(e):null!=e&&(t.escapeMode?i+=n(e):i+=e),i}function x(t,e){return""===t?e:t+"."+e}function _(t,e,i,n){var o="";if(0==t.length)o+=p(t,e,i,!0);else for(var s=0;s<t.length;s++)o+=p(t[s],e,g(t[s]),!1),o+=y(t[s],x(n,e)),o+=u(t[s],e);return o}function y(t,e){var i="";if(f(t)>0)for(var n in t)if(!d(t,n)&&(""==e||v(t,n,x(e,n)))){var o=t[n],s=g(o);if(null==o||void 0==o)i+=p(o,n,s,!0);else if(o instanceof Object)if(o instanceof Array)i+=_(o,n,s,e);else if(o instanceof Date)i+=p(o,n,s,!1),i+=o.toISOString(),i+=u(o,n);else{var r=f(o);r>0||null!=o.__text||null!=o.__cdata?(i+=p(o,n,s,!1),i+=y(o,x(e,n)),i+=u(o,n)):i+=p(o,n,s,!0)}else i+=p(o,n,s,!1),i+=A(o),i+=u(o,n)}return i+=A(t)}t=t||{},function(){void 0===t.escapeMode&&(t.escapeMode=!0),t.attributePrefix=t.attributePrefix||"_",t.arrayAccessForm=t.arrayAccessForm||"none",t.emptyNodeForm=t.emptyNodeForm||"text",void 0===t.enableToStringFunc&&(t.enableToStringFunc=!0),t.arrayAccessFormPaths=t.arrayAccessFormPaths||[],void 0===t.skipEmptyTextNodesForObj&&(t.skipEmptyTextNodesForObj=!0),void 0===t.stripWhitespaces&&(t.stripWhitespaces=!0),t.datetimeAccessFormPaths=t.datetimeAccessFormPaths||[],void 0===t.useDoubleQuotes&&(t.useDoubleQuotes=!1),t.xmlElementsFilter=t.xmlElementsFilter||[],t.jsonPropertiesFilter=t.jsonPropertiesFilter||[],void 0===t.keepCData&&(t.keepCData=!1)}();var b={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.parseXmlString=function(t){var e=window.ActiveXObject||"ActiveXObject"in window;if(void 0===t)return null;var i;if(window.DOMParser){var n=new window.DOMParser,o=null;if(!e)try{o=n.parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI}catch(t){o=null}try{i=n.parseFromString(t,"text/xml"),null!=o&&i.getElementsByTagNameNS(o,"parsererror").length>0&&(i=null)}catch(t){i=null}}else 0==t.indexOf("<?")&&(t=t.substr(t.indexOf("?>")+2)),i=new ActiveXObject("Microsoft.XMLDOM"),i.async="false",i.loadXML(t);return i},this.asArray=function(t){return void 0===t||null==t?[]:t instanceof Array?t:[t]},this.toXmlDateTime=function(t){return t instanceof Date?t.toISOString():"number"==typeof t?new Date(t).toISOString():null},this.asDateTime=function(t){return"string"==typeof t?r(t):t},this.xml2json=function(t){return c(t)},this.xml_str2json=function(t){var e=this.parseXmlString(t);return null!=e?this.xml2json(e):null},this.json2xml_str=function(t){return y(t,"")},this.json2xml=function(t){var e=this.json2xml_str(t);return this.parseXmlString(e)},this.getVersion=function(){return"1.2.0"}}});